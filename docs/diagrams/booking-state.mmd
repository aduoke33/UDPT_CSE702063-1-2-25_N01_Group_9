stateDiagram-v2
    [*] --> PENDING: User creates booking
    
    PENDING --> SEATS_LOCKED: Lock acquired
    PENDING --> FAILED: Lock failed (seats taken)
    
    SEATS_LOCKED --> AWAITING_PAYMENT: Seats reserved
    SEATS_LOCKED --> EXPIRED: Timeout (5 min)
    
    AWAITING_PAYMENT --> CONFIRMED: Payment successful
    AWAITING_PAYMENT --> FAILED: Payment failed
    AWAITING_PAYMENT --> EXPIRED: Payment timeout
    
    CONFIRMED --> CANCELLED: User cancels
    CONFIRMED --> COMPLETED: Showtime passed
    
    EXPIRED --> [*]: Locks released
    FAILED --> [*]: Error returned
    CANCELLED --> [*]: Refund processed
    COMPLETED --> [*]: Archived
